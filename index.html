<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Selmas Böcker</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }

        h1 {
            color: #2c3e50;
            text-align: center;
        }

        .add-book {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .add-book input {
            flex: 1;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
        }

        .add-book button {
            padding: 10px 20px;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }

        .add-book button:hover {
            background-color: #2980b9;
        }

        .stats {
            display: flex;
            justify-content: space-around;
            margin: 20px 0;
            padding: 15px;
            background-color: white;
            border-radius: 4px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .stat-item {
            display: flex;
            gap: 5px;
            align-items: center;
            padding: 5px 10px;
            border-radius: 4px;
        }

        .stat-item[data-status="unread"] {
            background-color: #f1c40f20;
        }

        .stat-item[data-status="reading"] {
            background-color: #2ecc7120;
        }

        .stat-item[data-status="completed"] {
            background-color: #3498db20;
        }

        .stat-value {
            font-weight: bold;
            font-size: 1.2em;
        }

        .book-list {
            list-style: none;
            padding: 0;
        }

        .book-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 15px;
            background-color: white;
            border-radius: 4px;
            margin-bottom: 10px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .book-info {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .book-title {
            font-weight: 500;
        }

        .book-meta {
            font-size: 0.9em;
            color: #666;
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .book-status {
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 14px;
            cursor: pointer;
            border: none;
            background-color: #eee;
            white-space: nowrap;
        }

        .book-status[data-status="unread"] {
            background-color: #f1c40f;
            color: #000;
        }

        .book-status[data-status="reading"] {
            background-color: #2ecc71;
            color: white;
        }

        .book-status[data-status="completed"] {
            background-color: #3498db;
            color: white;
        }

        .star-rating {
            display: flex;
            gap: 2px;
        }

        .star {
            cursor: pointer;
            font-size: 20px;
            color: #ddd;
        }

        .star.filled {
            color: #f1c40f;
        }

        .completion-date {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .completion-date input[type="date"] {
            padding: 3px 5px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
            color: #666;
        }

        .completion-date label {
            white-space: nowrap;
        }
    </style>
</head>
<body>
    <h1>Selmas Böcker</h1>
    
    <div class="add-book">
        <input type="text" id="bookInput" placeholder="Lägg till en ny bok...">
        <button onclick="addBook()">Lägg till</button>
    </div>

    <div class="stats">
        <span class="stat-item" data-status="unread">
            <span class="stat-label">Olästa:</span>
            <span class="stat-value" id="unreadCount">0</span>
        </span>
        <span class="stat-item" data-status="reading">
            <span class="stat-label">Läser:</span>
            <span class="stat-value" id="readingCount">0</span>
        </span>
        <span class="stat-item" data-status="completed">
            <span class="stat-label">Lästa:</span>
            <span class="stat-value" id="completedCount">0</span>
        </span>
    </div>

    <ul class="book-list" id="bookList"></ul>

    <script>
        // Hämta böcker från localStorage eller skapa en tom array
        let books = JSON.parse(localStorage.getItem('books')) || [];

        // Uppdatera statistik
        function updateStats() {
            const stats = books.reduce((acc, book) => {
                acc[book.status]++;
                return acc;
            }, {
                unread: 0,
                reading: 0,
                completed: 0
            });

            document.getElementById('unreadCount').textContent = stats.unread;
            document.getElementById('readingCount').textContent = stats.reading;
            document.getElementById('completedCount').textContent = stats.completed;
        }

        // Formatera datum för input field (YYYY-MM-DD)
        function formatDateForInput(date) {
            return new Date(date).toISOString().split('T')[0];
        }

        // Skapa stjärnbetyg element
        function createStarRating(book, index) {
            const container = document.createElement('div');
            container.className = 'star-rating';
            
            for (let i = 1; i <= 5; i++) {
                const star = document.createElement('span');
                star.className = 'star' + (i <= (book.rating || 0) ? ' filled' : '');
                star.textContent = '★';
                star.onclick = (e) => {
                    e.stopPropagation();
                    books[index].rating = i;
                    renderBooks();
                };
                container.appendChild(star);
            }
            
            return container;
        }

        // Skapa datum input element
        function createDateInput(book, index) {
            const container = document.createElement('div');
            container.className = 'completion-date';
            
            const label = document.createElement('label');
            label.textContent = 'Läst:';
            
            const input = document.createElement('input');
            input.type = 'date';
            input.value = formatDateForInput(book.completedDate || new Date());
            input.onchange = (e) => {
                books[index].completedDate = new Date(e.target.value).toISOString();
                renderBooks();
            };
            
            container.appendChild(label);
            container.appendChild(input);
            return container;
        }

        // Rendera boklistan
        function renderBooks() {
            const bookList = document.getElementById('bookList');
            bookList.innerHTML = '';
            
            books.forEach((book, index) => {
                const li = document.createElement('li');
                li.className = 'book-item';
                
                const bookInfo = document.createElement('div');
                bookInfo.className = 'book-info';
                
                const title = document.createElement('span');
                title.className = 'book-title';
                title.textContent = book.title;
                
                const meta = document.createElement('div');
                meta.className = 'book-meta';
                
                if (book.status === 'completed') {
                    meta.appendChild(createDateInput(book, index));
                    meta.appendChild(createStarRating(book, index));
                }
                
                bookInfo.appendChild(title);
                if (meta.children.length > 0) {
                    bookInfo.appendChild(meta);
                }
                
                const statusButton = document.createElement('button');
                statusButton.className = 'book-status';
                statusButton.setAttribute('data-status', book.status);
                statusButton.textContent = getStatusText(book.status);
                statusButton.onclick = () => toggleStatus(index);
                
                li.appendChild(bookInfo);
                li.appendChild(statusButton);
                bookList.appendChild(li);
            });
            
            // Spara till localStorage och uppdatera statistik
            localStorage.setItem('books', JSON.stringify(books));
            updateStats();
        }

        // Lägg till en ny bok
        function addBook() {
            const input = document.getElementById('bookInput');
            const title = input.value.trim();
            
            if (title) {
                books.push({
                    title: title,
                    status: 'unread'
                });
                input.value = '';
                renderBooks();
            }
        }

        // Växla status på en bok
        function toggleStatus(index) {
            const statusOrder = ['unread', 'reading', 'completed'];
            const currentStatus = books[index].status;
            const currentIndex = statusOrder.indexOf(currentStatus);
            const nextIndex = (currentIndex + 1) % statusOrder.length;
            const newStatus = statusOrder[nextIndex];
            
            books[index].status = newStatus;
            
            // Lägg till datum när boken markeras som läst
            if (newStatus === 'completed') {
                books[index].completedDate = new Date().toISOString();
            } else {
                // Ta bort datum och betyg om boken inte längre är läst
                delete books[index].completedDate;
                delete books[index].rating;
            }
            
            renderBooks();
        }

        // Få text för status
        function getStatusText(status) {
            const statusTexts = {
                'unread': 'Oläst',
                'reading': 'Läser',
                'completed': 'Klar'
            };
            return statusTexts[status];
        }

        // Lägg till bok när man trycker Enter
        document.getElementById('bookInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                addBook();
            }
        });

        // Initial rendering
        renderBooks();
    </script>
</body>
</html>
